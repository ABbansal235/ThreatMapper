package utils

import (
	"io/ioutil"
	"os"
	"strings"

	log "github.com/sirupsen/logrus"
)

func ValidateSbom(userInput []byte) error {
	return nil
}

// Escape escapes the user input to be used as a command line argument
// removes all the double quotes
func Escape(userInput []byte) []byte {
	st := string(userInput)
	// re is \"
	re := `\"`
	st = strings.Replace(st, "\"", re, -1)
	return []byte(st)
}

func TempSBOMFile(userInput []byte) (*os.File, error) {
	file, err := ioutil.TempFile("/tmp", "sbom.*.json")
	if err != nil {
		log.Fatal(err)
	}

	// write the user input to the file
	_, err = file.Write(userInput)
	if err != nil {
		return nil, err
	}

	return file, err
}

func TrimSuffix(s, suffix string) string {
	if strings.HasSuffix(s, suffix) {
		s = s[:len(s)-len(suffix)]
	}
	return s
}

func WriteToFile(b []byte) error {
	return os.WriteFile("/tmp/dat1", b, 0644)
}
